"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var h=e[i];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(t,h.key,h)}}return function(e,i,h){return i&&t(e.prototype,i),h&&t(e,h),e}}(),AVLTree=function(){function t(e){_classCallCheck(this,t),e&&(this.root=new Node(e))}return _createClass(t,[{key:"insert",value:function(t){return this.root?this.root.insert(t):this.root=new Node(t),this.root.update(),this.balance(),this}},{key:"rotateRight",value:function(t){this.root.get(t).rotateRight(this),this.root.update()}},{key:"rotateLeft",value:function(t){this.root.get(t).rotateLeft(this),this.root.update()}},{key:"balance",value:function(){var t,e=0;this.root.posOrder(function(i){Math.abs(i.balancing)>=2&&(e++,1==e&&(t=i))}),0!=e&&(t.balancing<0?t.left.balancing<0?this.rotateRight(t.value):this.doubleRotateLeft(t.value):t.right.balancing>0?this.rotateLeft(t.value):this.doubleRotateRight(t.value),this.balance())}},{key:"doubleRotateLeft",value:function(t){var e=this.root.get(t);e.left.rotateLeft(this),e.rotateRight(this),this.root.update()}},{key:"doubleRotateRight",value:function(t){var e=this.root.get(t);e.right.rotateRight(this),e.rotateLeft(this),this.root.update()}},{key:"preOrder",value:function(t){this.root.preOrder(t)}}]),t}(),Node=function(){function t(e,i){_classCallCheck(this,t),this.value=e,this.parent=i,this.height=0,i&&(this.height=i.height+1)}return _createClass(t,[{key:"updateHeight",value:function(){var t=0;return this.left&&(t=this.left.updateHeight()),this.right&&this.right.updateHeight()>t&&(t=this.right.height),t+=1,this.height=t,t}},{key:"rotateLeft",value:function(t){var e=this.right,i=e.left;if(e.left=this,this.parent){var h=this.parent.left==this?"left":"right";this.parent[h]=e}else t.root=e,e.parent=null;e.parent=this.parent,null==this.parent&&(t.root=e),this.parent=e,this.left=i,i&&(i.parent=this)}},{key:"rotateRight",value:function(t){var e=this.left;if(this.parent){var i=this.parent.left==this?"left":"right";this.parent[i]=e,e.parent=this.parent}else t.root=e,e.parent=null;this.left=e.right,this.left&&(this.left.parent=this),e.right=this,this.parent=e}},{key:"isLeaf",value:function(){return!this.left&&!this.right}},{key:"countNodes",value:function(){if(this.isLeaf())return 1;var t=1;return this.left&&(t+=this.left.countNodes()),this.right&&(t+=this.right.countNodes()),t}},{key:"countChilds",value:function(){return this.countNodes()-1}},{key:"posOrder",value:function(t){this.left&&this.left.posOrder(),this.right&&this.right.posOrder(),t(this)}},{key:"update",value:function(){this.updateHeight(),this.updateBalancing()}},{key:"updateBalancing",value:function(){var t=0;this.right&&(t=this.right.height,this.right.updateBalancing()),this.left&&(t-=this.left.height,this.left.updateBalancing()),this.balancing=t}},{key:"hasValue",value:function(t){return this.value==t||(t<this.value?!!this.left&&this.left.hasValue(t):t>this.value?!!this.right&&this.right.hasValue(t):void 0)}},{key:"insert",value:function(e){return e>this.value&&(this.right?this.right.insert(e):this.right=new t(e,this)),e<this.value&&(this.left?this.left.insert(e):this.left=new t(e,this)),this.update(),this}},{key:"get",value:function(t){return this.hasValue(t)?t==this.value?this:t<this.value?this.left.get(t):t>this.value?this.right.get(t):void 0:null}},{key:"biggest",value:function(){return this.right?this.right.biggest():this}},{key:"smallest",value:function(){return this.left?this.left.smallest():this}},{key:"successor",value:function(){return this.right?this.right.smallest():null}},{key:"antecessor",value:function(){return this.left?this.left.biggest():null}},{key:"preOrder",value:function(t){t(this),this.left&&this.left.preOrder(t),this.right&&this.right.preOrder(t)}},{key:"posOrder",value:function(t){this.left&&this.left.posOrder(t),this.right&&this.right.posOrder(t),t(this)}},{key:"getUnbalancedsfunction",value:function(){var t=[];return this.update(),this.preOrder(function(e){Math.abs(e.balancing)>=2&&t.push(e)}),t}}]),t}();module.exports=AVLTree;